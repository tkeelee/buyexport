# 淘宝订单批量导出工具 (Tampermonkey Script)

这是一个基于油猴（Tampermonkey）的浏览器用户脚本，用于帮助用户从淘宝“已买到的宝贝”页面批量导出订单数据到 Excel 文件。

## 功能特性

- **一键导出**：在页面集成悬浮面板，一键启动采集流程。
- **深度抓取**：脚本不仅采集列表页信息，还会自动在后台抓取订单详情页，获取更完整的数据。
- **字段丰富**：支持导出以下 19 个关键字段：
  - **基础信息**：订单号、店铺名称、商品标题、商品规格、交易状态。
  - **价格信息**：单价、**原价**（识别划线价）、数量、实付款、**运费**。
  - **详细信息**：**收件人信息**（姓名/电话/地址）、**支付宝交易号**、**交易快照链接**、**商品主图链接**。
  - **时间节点**：下单时间、创建时间、付款时间、发货时间、成交时间。
- **防封保护**：采用**单线程串行**抓取模式，配合**随机延时**（2-5秒）和**自动中场休息**（每5单暂停10秒），最大程度模拟真人操作，防止触发淘宝验证码或拦截。
- **智能去重**：对于包含多个商品的同一订单，脚本会自动去重，只抓取一次详情页，效率更高。
- **断点保存**：支持在导出过程中随时点击 **“取消导出”**，脚本会自动保存并导出目前已获取到的所有数据，避免因意外中断导致前功尽弃。
- **自动翻页**：脚本会自动点击“下一页”遍历所有订单分页，无需人工干预。
- **Excel 导出**：采集完成后自动生成 `.xlsx` 格式文件，数据结构清晰。

## 安装指南

1.  **安装油猴插件**：
    -   如果你使用的是 Chrome 浏览器，请前往 Chrome 应用商店安装 [Tampermonkey](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)。
    -   如果你使用的是 Edge、Firefox 或其他浏览器，请在相应的扩展商店搜索安装 Tampermonkey。

2.  **添加脚本**：
    -   打开 Tampermonkey 管理面板，点击“添加新脚本”。
    -   将本项目中 `taobao_export.user.js` 文件的所有代码复制并粘贴到编辑器中。
    -   点击“文件” -> “保存”。

## 使用方法

1.  登录淘宝网页版。
2.  进入 [已买到的宝贝](https://buyertrade.taobao.com/trade/itemlist/list_bought_items.htm) 页面。
3.  页面加载完成后（约等待 2 秒），页面右上角会出现一个悬浮框。
4.  点击 **“批量导出所有订单”** 按钮。
5.  脚本将开始自动采集当前页数据，并**实时显示**详情页的抓取进度（状态栏会提示当前的暂停状态，请耐心等待）。
6.  **取消导出**：如果需要中途停止，可以点击悬浮窗上的 **“取消导出”** 按钮，脚本将停止后续抓取并导出当前已收集的数据。
7.  当采集到最后一页或用户手动取消时，浏览器将自动下载名为 `淘宝订单导出_xxxx.xlsx` 的文件。

## 注意事项

-   **抓取速度**：为了防止被淘宝拦截（触发 "unusual traffic" 错误），脚本特意大幅**放慢了抓取速度**（每个订单间隔数秒，每批次有长暂停）。请务必**耐心等待**，不要频繁刷新页面或点击其他链接。
-   **防封建议**：如果遇到拦截，请关闭淘宝页面等待 10-20 分钟后再试，或切换网络环境（如使用手机热点）。
-   **页面滚动**：脚本会自动滚动页面以触发懒加载图片和数据，请勿打断。
-   **兼容性**：脚本基于当前的淘宝页面结构开发，如果淘宝更新了页面代码，脚本可能会失效。

## 数据隐私

本脚本所有数据采集和处理均在您的本地浏览器中进行，不会将任何数据上传到第三方服务器，请放心使用。
